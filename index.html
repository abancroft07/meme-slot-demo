<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Meme Arcade ‚Äî Doge Slots (Demo)</title>
  <style>
    :root{
      --bg1:#0f1724; --bg2:#2b0b3a;
      --card:#0b1220; --accent:#ffd166; --accent2:#ff5d8f;
      --glass: rgba(255,255,255,0.04);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    html,body{height:100%; margin:0; background:linear-gradient(135deg,var(--bg1),var(--bg2)); color:#e6eef8}
    .wrap{min-height:100vh; display:flex; align-items:center; justify-content:center; padding:28px}
    .card{width:980px; max-width:96vw; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border-radius:18px; box-shadow:0 10px 40px rgba(2,6,23,0.6); padding:20px; display:grid; grid-template-columns: 360px 1fr; gap:18px}
    .left{padding:14px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.02), transparent)}
    h1{margin:0; font-size:20px;}
    .balance{margin-top:10px; font-weight:700; font-size:18px; color:var(--accent)}
    .btn {background:linear-gradient(90deg,var(--accent) 0%, var(--accent2)100%); border:none; padding:10px 16px; color:#071021; border-radius:12px; font-weight:700; cursor:pointer; box-shadow:0 6px 18px rgba(255,90,120,0.12)}
    .btn:disabled{opacity:0.5; cursor:not-allowed}
    .small{font-size:13px; color:#bcd2ef}
    .wallet {margin-top:12px; display:flex; gap:8px; align-items:center}
    .reel-wrap{display:flex; gap:10px; padding:18px; justify-content:center}
    .reel{width:96px; height:180px; background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01)); border-radius:12px; overflow:hidden; border:1px solid rgba(255,255,255,0.03); display:flex; flex-direction:column; align-items:center; justify-content:center}
    .symbol{font-size:36px; height:60px; width:80px; display:flex; align-items:center; justify-content:center; margin:6px; border-radius:8px; background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01)); color:#071021; font-weight:800}
    .controls{display:flex; flex-direction:column; gap:10px; margin-top:12px}
    .right{padding:18px; border-radius:12px; background:linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.005)); display:flex; flex-direction:column}
    .history{margin-top:8px; max-height:220px; overflow:auto; padding:8px; background:rgba(255,255,255,0.02); border-radius:10px}
    .notice{font-size:13px; color:#bcd2ef; margin-top:8px}
    .big-win{position:fixed; left:50%; transform:translateX(-50%); top:12vh; display:none; z-index:50; padding:12px 18px; border-radius:14px; font-weight:900; font-size:22px; color:#082; background:linear-gradient(90deg,#fff9d4,#ffe0b8); color:#071021; box-shadow:0 12px 40px rgba(0,0,0,0.4)}
    /* confetti pieces */
    .confetti{position:fixed; left:0; top:0; width:100%; height:100%; pointer-events:none; overflow:hidden}
    .confetti i{position:absolute; width:10px; height:14px; opacity:0; transform-origin:center; transform:translateY(-30px) rotate(0deg); animation:confetti 1.5s linear forwards}
    @keyframes confetti{
      0%{opacity:1; transform:translateY(-20px) rotate(0deg)}
      100%{opacity:1; transform:translateY(100vh) rotate(420deg)}
    }
    /* mobile responsiveness */
    @media (max-width:900px){
      .card{grid-template-columns:1fr; padding:12px}
      .left{order:2}
      .right{order:1}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <!-- LEFT: player & controls -->
      <div class="left">
        <h1>Meme Arcade ‚Äî Doge Slots (Demo)</h1>
        <div class="small">A demo slots machine that uses fake in-game "Doge Credits". No real money required. Save your progress in your browser.</div>
        <div class="balance" id="balance">Doge Credits: 0</div>

        <div class="wallet">
          <button class="btn" id="connectBtn">Connect Wallet (placeholder)</button>
          <div class="small">Wallet connects will be cosmetic until you add on-chain later.</div>
        </div>

        <div style="margin-top:14px;">
          <div style="font-weight:800;margin-bottom:6px;">Machine</div>
          <div class="reel-wrap" id="reelWrap">
            <!-- reels generated by JS -->
          </div>

          <div class="controls">
            <div style="display:flex; gap:10px">
              <button class="btn" id="spinBtn">Spin (10)</button>
              <button class="btn" id="maxSpinBtn">Max Spin (50)</button>
            </div>
            <div style="display:flex; gap:10px; margin-top:6px">
              <button class="btn" id="freeSpinBtn">Daily Free Spin</button>
              <button class="btn" id="resetBtn" style="background:#4b5563; color:#fff">Reset Progress</button>
            </div>
          </div>

          <div class="notice" id="message">Welcome! Try a spin ‚Äî you get daily free spin and more as you play.</div>
        </div>
      </div>

      <!-- RIGHT: history / shop placeholder -->
      <div class="right">
        <div style="display:flex; justify-content:space-between; align-items:center">
          <div style="font-weight:900">Play History</div>
          <div class="small">Your last spins</div>
        </div>

        <div class="history" id="history"></div>

        <div style="margin-top:12px">
          <div style="font-weight:900">Shop (coming soon)</div>
          <div class="small">Cosmetics, mystery boxes, subscriptions ‚Äî add these later when you're ready to monetize.</div>
        </div>

        <div style="margin-top:14px">
          <div style="font-weight:800">Game Info</div>
          <div class="small" style="margin-top:6px">
            Symbols: üê∂ DOGE, üê∏ PEPE, üöÄ ROCKET, üåï MOON, üèéÔ∏è LAMBO<br/>
            Payout sample: 5-in-row same symbol = big jackpot; 3-in-row (leftmost) = small win.<br/>
            This demo uses fake credits stored in your browser's memory (localStorage). No real crypto is moved.
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="big-win" id="bigWin">BIG WIN!</div>
  <div class="confetti" id="confetti"></div>

<script>
/*
  Meme Slots Demo
  - 5 reels x 3 rows
  - fake credits stored in localStorage key "meme_slots_balance"
  - daily free spin tracked by localStorage date
  - simple payout rules for demo purposes
*/

const SYMBOLS = ['üê∂','üê∏','üöÄ','üåï','üèéÔ∏è']; // Doge, Pepe, Rocket, Moon, Lambo
const REELS = 5;
const ROWS = 3;

// DOM
const reelWrap = document.getElementById('reelWrap');
const balanceEl = document.getElementById('balance');
const spinBtn = document.getElementById('spinBtn');
const maxSpinBtn = document.getElementById('maxSpinBtn');
const freeSpinBtn = document.getElementById('freeSpinBtn');
const historyEl = document.getElementById('history');
const messageEl = document.getElementById('message');
const bigWinEl = document.getElementById('bigWin');
const confettiEl = document.getElementById('confetti');

// localStorage keys
const BAL_KEY = 'meme_slots_balance';
const HISTORY_KEY = 'meme_slots_history';
const FREE_SPIN_KEY = 'meme_slots_free_date';

// initialize reels UI
for(let i=0;i<REELS;i++){
  const reel = document.createElement('div');
  reel.className = 'reel';
  reel.setAttribute('data-reel', i);
  // create 3 visible symbol placeholders
  for(let r=0;r<ROWS;r++){
    const sym = document.createElement('div');
    sym.className = 'symbol';
    sym.textContent = SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)];
    reel.appendChild(sym);
  }
  reelWrap.appendChild(reel);
}

// helpers: storage
function getBalance(){ return parseInt(localStorage.getItem(BAL_KEY) || '1000', 10); } // start with 1000 credits
function setBalance(n){ localStorage.setItem(BAL_KEY, String(n)); updateBalanceUI(); }
function addHistory(entry){
  const h = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
  h.unshift(entry);
  if(h.length>50) h.pop();
  localStorage.setItem(HISTORY_KEY, JSON.stringify(h));
  renderHistory();
}
function renderHistory(){
  const h = JSON.parse(localStorage.getItem(HISTORY_KEY) || '[]');
  historyEl.innerHTML = h.map(it=>`<div style="padding:6px;border-bottom:1px dashed rgba(255,255,255,0.02)"><strong>${it.result}</strong> ‚Äî ${it.delta>0?'+':''}${it.delta} (${it.bet} bet)</div>`).join('');
}
function updateBalanceUI(){ balanceEl.textContent = `Doge Credits: ${getBalance().toLocaleString()}`; }

updateBalanceUI(); renderHistory();

// spin logic
let spinning=false;

function randomOutcome(){
  // produce grid [rows][reels]
  const grid = Array.from({length:ROWS}, ()=>Array(REELS).fill(''));
  for(let c=0;c<REELS;c++){
    for(let r=0;r<ROWS;r++){
      grid[r][c] = SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)];
    }
  }
  return grid;
}

function evaluatePayout(grid, bet){
  // simple rules:
  // center row 5-of-kind = jackpot x200
  // center row 5 same = x200
  // center row first 3 same = x5
  // any 3 in a column = x2 (mini)
  // This is a demo - tune as needed.
  const center = grid[1];
  let payout = 0;
  if(center.every(s=>s===center[0])){
    payout = bet * 200;
  } else {
    const first3 = center.slice(0,3);
    if(first3.every(s=>s===first3[0])) payout = bet * 5;
  }
  // mini: any column with the same 3 symbols
  for(let c=0;c<REELS;c++){
    const col = [grid[0][c], grid[1][c], grid[2][c]];
    if(col.every(s=>s===col[0])) payout += bet * 2;
  }
  return payout;
}

// visual spin: animate placeholders quickly then stop with final grid
function animateSpin(finalGrid, spinTime=1200){
  return new Promise(resolve=>{
    const reels = document.querySelectorAll('.reel');
    const intervals = [];
    reels.forEach((r, idx)=>{
      // start rapid change
      intervals[idx] = setInterval(()=>{
        const syms = r.querySelectorAll('.symbol');
        syms.forEach(s=> s.textContent = SYMBOLS[Math.floor(Math.random()*SYMBOLS.length)]);
      }, 90 + Math.random()*40);
    });
    // stop reels one by one and set final symbols
    for(let i=0;i<reels.length;i++){
      setTimeout(()=>{
        clearInterval(intervals[i]);
        const syms = reels[i].querySelectorAll('.symbol');
        for(let row=0;row<ROWS;row++){
          syms[row].textContent = finalGrid[row][i];
        }
        // small bounce effect
        reels[i].animate([{transform:'translateY(-6px)'},{transform:'translateY(0)'}], {duration:220, easing:'cubic-bezier(.25,.75,.35,1)'});
        if(i===reels.length-1) setTimeout(resolve, 220);
      }, 350 + i*220);
    }
  });
}

function spawnConfetti(){
  confettiEl.innerHTML='';
  const colors = ['#FFD166','#4ADE80','#60A5FA','#F472B6','#FB7185','#A78BFA'];
  for(let i=0;i<40;i++){
    const el = document.createElement('i');
    el.style.left = (Math.random()*100)+'%';
    el.style.top = '-10%';
    el.style.background = colors[Math.floor(Math.random()*colors.length)];
    el.style.transform = `rotate(${Math.random()*360}deg)`;
    el.style.width = (6+Math.random()*10)+'px';
    el.style.height = (8+Math.random()*12)+'px';
    el.style.animationDelay = (Math.random()*0.2)+'s';
    el.style.opacity = 1;
    confettiEl.appendChild(el);
  }
  setTimeout(()=> confettiEl.innerHTML='', 1600);
}

async function doSpin(bet){
  if(spinning) return;
  const bal = getBalance();
  if(bet>bal){
    messageEl.textContent = 'Not enough credits ‚Äî use Daily Free Spin or reset to get new free credits.';
    return;
  }
  spinning=true;
  spinBtn.disabled = true; maxSpinBtn.disabled=true;
  messageEl.textContent = 'Spinning... good luck!';
  const final = randomOutcome();
  await animateSpin(final);
  const payout = evaluatePayout(final, bet);
  const newBal = getBalance() - bet + payout;
  setBalance(newBal);
  let resultText = '';
  if(payout>0){
    resultText = `WIN ${payout}`;
    // big win visuals for big jackpots
    if(payout >= bet * 200){
      bigWinEl.textContent = 'JACKPOT! BIG WIN!';
      bigWinEl.style.display='block';
      spawnConfetti();
      setTimeout(()=> bigWinEl.style.display='none', 1600);
    }
  } else {
    resultText = 'No win';
  }
  addHistory({result: resultText, delta: payout - bet, bet});
  messageEl.textContent = payout>0 ? `You won ${payout} credits!` : 'No win ‚Äî try again!';
  spinning=false;
  spinBtn.disabled = false; maxSpinBtn.disabled=false;
}

// daily free spin logic
function canGetFreeSpinToday(){
  const today = new Date().toISOString().slice(0,10);
  return localStorage.getItem(FREE_SPIN_KEY) !== today;
}
function claimFreeSpin(){
  if(!canGetFreeSpinToday()){
    messageEl.textContent = 'Free spin already claimed today. Come back tomorrow!';
    return;
  }
  // grant a small free spin (bet 0 that randomly gives small prize or token)
  localStorage.setItem(FREE_SPIN_KEY, new Date().toISOString().slice(0,10));
  // free spin runs with a small bet simulated
  const bet = 0;
  // to make it fun, we give a guaranteed small reward: random 5-50 credits
  const bonus = 20 + Math.floor(Math.random()*31);
  const newBal = getBalance() + bonus;
  setBalance(newBal);
  addHistory({result:`Free Spin Bonus ${bonus}`, delta: bonus, bet:0});
  messageEl.textContent = `Daily Free Spin claimed! You got ${bonus} credits.`;
}

// reset (for testing)
document.getElementById('resetBtn').addEventListener('click', ()=>{
  if(confirm('Reset local progress? This will clear balance and history saved in this browser.')){
    localStorage.removeItem(BAL_KEY);
    localStorage.removeItem(HISTORY_KEY);
    localStorage.removeItem(FREE_SPIN_KEY);
    updateBalanceUI(); renderHistory();
    messageEl.textContent = 'Progress reset. You have default starting credits.';
  }
});

// buttons
spinBtn.addEventListener('click', ()=> doSpin(10));
maxSpinBtn.addEventListener('click', ()=> doSpin(50));
freeSpinBtn.addEventListener('click', claimFreeSpin);
document.getElementById('connectBtn').addEventListener('click', ()=> alert('Wallet connect placeholder ‚Äî add WalletConnect/MetaMask later.'));

// ensure starting balance exists
if(!localStorage.getItem(BAL_KEY)) localStorage.setItem(BAL_KEY, '1000');
updateBalanceUI();

// small UX tip: pressing space triggers spin
document.addEventListener('keydown', (e)=>{ if(e.code==='Space') { e.preventDefault(); doSpin(10); }});

// On load: tiny friendly tutorial if first-time
if(!localStorage.getItem('meme_slots_seen')) {
  alert('Welcome to Meme Arcade Slots demo! You start with 1000 Doge Credits. Use Daily Free Spin once per day. Press Spin to play.');
  localStorage.setItem('meme_slots_seen','1');
}
</script>
</body>
</html>
